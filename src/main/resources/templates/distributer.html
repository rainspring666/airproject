<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8" />
		<title>派单管理</title>
		<link rel="stylesheet" th:href="@{/css/layui.css}" />
	</head>
	<body>

		<table class="layui-hide" id="table" lay-filter="test"></table>

		<script type="text/html" id="barDemo">
			<form action="" class="layui-form layui-btn layui-btn-xs">
				<select name="time" lay-verify="required" lay-ignore lay-event="select">
					<option value=""></option>
					<option value="亚瑟">亚瑟</option>
					<option value="妲己">妲己</option>
					<option value="安其拉">安其拉</option>
					<option value="宫本武藏">宫本武藏</option>
					<option value="瑶">瑶</option>
				</select>
			</form>
			
			<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
			<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="confirm">确定</a>
		</script>
		
		<script th:src="@{/layui.js}"></script>


		<script>
			layui.use(['table', 'layer', 'form'], function() {
				var table = layui.table,
					form = layui.form,
					layer = layui.layer;
					$ = layui.jquery;

				table.render({
					elem: '#table',
					height: 500,
					// ,url: ''//数据接口
					data: [

						{
							"id": 1,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 2,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 3,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 4,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 5,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 6,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 7,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 8,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 9,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 10,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 11,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 12,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 13,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 14,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 15,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10：00",
							// "sign": "签名-0"
						},

						{
							"id": 16,
							"username": "user-0",
							"orderClass": "家居",
							"time": "6-5 10:00",
							// "sign": "签名-0"
						}

					],
					title: '用户表',
					page: true, //开启分页
					toolbar: 'default', //开启工具栏，此处显示默认图标，可以自定义模板，详见文档
					totalRow: true, //开启合计行
					cols: [
						[ //表头
							{
								type: 'checkbox',
								fixed: 'left'
							}, {
								field: 'id',
								title: 'ID',
								width: 80,
								sort: true,
								fixed: 'left',
								totalRowText: '合计：'
							}, {
								field: 'username',
								title: '用户名',
								width: 80
							}
							// ,{field: 'experience', title: '积分', width: 90, sort: true, totalRow: true}
							, {
								field: 'orderClass',
								title: '类别',
								width: 80,
								sort: true
							}
							// ,{field: 'score', title: '评分', width: 80, sort: true, totalRow: true}
							, {
								field: 'time',
								title: '时间',
								width: 150
							}, 
							// {
							// 	field: 'sign',
							// 	title: '签名',
							// 	width: 200
							// }
							// ,{field: 'classify', title: '职业', width: 100}
							// ,{field: 'wealth', title: '财富', width: 135, sort: true, totalRow: true}
							, {
								fixed: 'right',
								width: 220,
								align: 'center',
								toolbar: '#barDemo'
							}
						]
					]
				});

				//监听行工具事件
				var worker = "";
				table.on('tool(test)', function(obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
					var data = obj.data //获得当前行数据
						,
						layEvent = obj.event; //获得 lay-event 对应的值
					
					if (layEvent === 'select') {
						console.log(this.value);
						worker = this.value;
					} else if (layEvent === 'confirm' && worker) {
						layer.confirm('确定选用 ' + worker + ' ?', function(index) {
							// 派单接口，分配工作人员
							$.ajax({
								url: '',
								data: {'data':'gg'},
								type: 'Post',
								dataType: 'json',
								success: function(data){
									console.log("成功！");
								},
								error: function(data){
									console.log('ajax');
								}
							});
							obj.del(); //删除对应行（tr）的DOM结构
							// layer.close(index);
							//向服务端发送删除指令
							console.log('人员选定成功！', worker);
							worker = '',
							layer.close(index);
						});
					} else if (layEvent === 'edit') {
						layer.msg('编辑操作');
					}
				});

			})
		</script>

	</body>
</html>
